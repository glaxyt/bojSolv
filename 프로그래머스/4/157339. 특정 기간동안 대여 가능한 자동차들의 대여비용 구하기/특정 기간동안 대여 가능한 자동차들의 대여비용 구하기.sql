
SELECT C1.CAR_ID, C1.CAR_TYPE, ROUND((C1.DAILY_FEE * 30) * ((100 - DISCOUNT_RATE) / 100)) AS FEE
FROM CAR_RENTAL_COMPANY_CAR AS C1 JOIN CAR_RENTAL_COMPANY_DISCOUNT_PLAN AS C2 ON C1.CAR_TYPE = C2.CAR_TYPE AND C2.DURATION_TYPE = '30일 이상'
WHERE ROUND((C1.DAILY_FEE * 30) * ((100 - DISCOUNT_RATE) / 100)) >= 500000 AND ROUND((C1.DAILY_FEE * 30) * ((100 - DISCOUNT_RATE) / 100)) < 2000000 AND CAR_ID NOT IN (SELECT CAR_ID
                FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
                WHERE '2022-11-01' <= END_DATE AND '2022-11-30'>= START_DATE)
ORDER BY FEE DESC, CAR_TYPE ASC, CAR_ID DESC
